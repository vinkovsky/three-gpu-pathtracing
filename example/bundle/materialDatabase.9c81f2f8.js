var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},a=e.parcelRequire5b70;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in n){var a=n[e];delete n[e];var o={id:e,exports:{}};return t[e]=o,a.call(o.exports,o,o.exports),o.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){n[e]=t},e.parcelRequire5b70=a);var o=a("ilwiq"),r=a("RPVlj"),i=a("7lx9d"),s=a("5Rd1x"),l=a("4CEV9"),d=a("cVdfP"),m=a("891vQ"),c=a("kp7Te"),u=a("jiuw3");let p,h,g,b,w,y,f,v,C,M,x,I,B,E,F;const R={hideInfo:!1,acesToneMapping:!0,stableNoise:!1,tiles:2,bounces:5,multipleImportanceSampling:!0,resolutionScale:1/window.devicePixelRatio,environmentBlur:0,environmentIntensity:1,environmentRotation:0,backgroundBlur:.1,filterGlossyFactor:.5};function T(){const e=window.innerWidth,t=window.innerHeight,n=R.resolutionScale,a=window.devicePixelRatio;b.setSize(e*n*a,t*n*a),b.reset(),p.setSize(e,t),p.setPixelRatio(window.devicePixelRatio*n);const o=e/t;f.aspect=o,f.updateProjectionMatrix()}function S(){const e=M.generate(C,R.environmentBlur);b.material.envMapInfo.updateFrom(e),x.environment=e,b.reset()}function G(){requestAnimationFrame(G),F.style.visibility=R.hideInfo?"hidden":"visible";const e=v[R.material],[t,n]=y;!function(e,t){t.color.set(16777215),t.transmission=0,t.attenuationDistance=1/0,t.attenuationColor.set(16777215),t.specularColor.set(16777215),t.metalness=0,t.roughness=1,t.ior=1.5,t.thickness=1,e.specularColor&&t.specularColor.setRGB(...e.specularColor),"metalness"in e&&(t.metalness=e.metalness),"roughness"in e&&(t.roughness=e.roughness),"ior"in e&&(t.ior=e.ior),"transmission"in e&&(t.transmission=e.transmission),t.transmission?(e.color&&t.attenuationColor.setRGB(...e.color),t.attenuationDistance=200/e.density):e.color&&t.color.setRGB(...e.color);const n=e.name.replace(/\s+/g,"-").replace(/[()]+/g,"");E.src=`https://physicallybased.info/reference/render/${n}-cycles.webp`,B.innerText=`${e.description}`,B.style.display=e.description?"inline-block":"none"}(e,t),n.color.setRGB(.5,.5,.5).convertSRGBToLinear(),n.roughness=1,n.metalness=0,b.material.materials.updateFrom(g.materials,g.textures),b.material.filterGlossyFactor=R.filterGlossyFactor,b.material.environmentIntensity=R.environmentIntensity,b.material.backgroundBlur=R.backgroundBlur,b.material.bounces=R.bounces,b.material.physicalCamera.updateFrom(f),f.updateMatrixWorld(),R.backgroundAlpha<1?x.background=null:x.background=x.environment,b.update(),b.samples<1&&p.render(x,f),p.autoClear=!1,w.material.map=b.target.texture,w.render(p),p.autoClear=!0,I.innerText=`Samples: ${Math.floor(b.samples)}`}window.innerWidth/window.innerHeight<.65&&(R.bounces=Math.max(R.bounces,6),R.resolutionScale*=.5,R.tiles=2,R.multipleImportanceSampling=!1,R.environmentBlur=.35,R.hideInfo=!0),async function(){p=new o.WebGLRenderer({antialias:!0}),p.toneMapping=o.ACESFilmicToneMapping,p.outputEncoding=o.sRGBEncoding,p.setClearColor(0,0),document.body.appendChild(p.domElement);const e=window.innerWidth/window.innerHeight;f=new o.PerspectiveCamera(75,e,.025,500),f.position.set(-4,2,3),b=new l.PathTracingRenderer(p),b.camera=f,b.material=new l.PhysicalPathTracingMaterial,b.material.setDefine("FEATURE_MIS",Number(R.multipleImportanceSampling)),b.tiles.set(R.tiles,R.tiles),w=new r.FullScreenQuad(new o.MeshBasicMaterial({map:b.target.texture,blending:o.CustomBlending,premultipliedAlpha:p.getContextAttributes().premultipliedAlpha})),h=new s.OrbitControls(f,p.domElement),h.addEventListener("change",(()=>{b.reset()})),x=new o.Scene,I=document.getElementById("samples"),B=document.getElementById("materialInfo"),E=document.getElementById("materialImage"),F=document.getElementById("info"),M=new l.BlurredEnvMapGenerator(p);const t=(new m.RGBELoader).setDataType(o.FloatType).loadAsync("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/master/hdri/autoshop_01_1k.hdr").then((e=>{C=e,S()})),n=new d.PathTracingSceneWorker,a=(new i.GLTFLoader).setMeshoptDecoder(c.MeshoptDecoder).loadAsync("https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/material-balls/material_ball_v2.glb").then((e=>{const t=new o.Group;e.scene.scale.setScalar(.01),e.scene.updateMatrixWorld(),t.add(e.scene);const a=new o.Box3;a.setFromObject(e.scene);const r=new o.Mesh(new o.CylinderGeometry(3,3,.05,200),new o.MeshPhysicalMaterial({color:16777215,roughness:0,metalness:.25}));r.geometry=r.geometry.toNonIndexed(),r.geometry.clearGroups(),r.position.y=a.min.y-.03,t.add(r);const i=new o.MeshPhysicalMaterial,s=new o.MeshPhysicalMaterial;return e.scene.traverse((e=>{e.geometry&&e.geometry.computeVertexNormals(),"Sphere_1"===e.name?e.material=s:e.material=i,"subsphere_1"===e.name&&(e.material=s)})),y=[i,s,r.material],n.generate(t)})).then((e=>{g=e,x.add(e.scene);const{bvh:t,textures:a,materials:o}=e,r=t.geometry,i=b.material;i.bvh.updateFrom(t),i.attributesArray.updateFrom(r.attributes.normal,r.attributes.tangent,r.attributes.uv,r.attributes.color),i.materialIndexAttribute.updateFrom(r.attributes.materialIndex),i.textures.setTextures(p,2048,2048,a),i.materials.updateFrom(o,a),n.dispose()})),P=fetch("https://api.physicallybased.info/materials").then((e=>e.json())).then((e=>{v={},e.forEach((e=>{v[e.name]=e}))}));await Promise.all([P,a,t]),document.getElementById("loading").remove(),T(),window.addEventListener("resize",T);const k=new u.GUI,A=Object.keys(v);R.material=A[0],k.add(R,"material",A).onChange((()=>{b.reset()})),k.add(R,"hideInfo");const N=k.addFolder("Path Tracing");N.add(R,"acesToneMapping").onChange((e=>{p.toneMapping=e?o.ACESFilmicToneMapping:o.NoToneMapping,w.material.needsUpdate=!0})),N.add(R,"stableNoise").onChange((e=>{b.stableNoise=e})),N.add(R,"multipleImportanceSampling").onChange((e=>{b.material.setDefine("FEATURE_MIS",Number(e)),b.reset()})),N.add(R,"tiles",1,4,1).onChange((e=>{b.tiles.set(e,e)})),N.add(R,"filterGlossyFactor",0,1).onChange((()=>{b.reset()})),N.add(R,"bounces",1,30,1).onChange((()=>{b.reset()})),N.add(R,"resolutionScale",.1,1).onChange((()=>{T()}));const _=k.addFolder("Environment");_.add(R,"environmentIntensity",0,10).onChange((()=>{b.reset()})),_.add(R,"environmentRotation",0,2*Math.PI).onChange((e=>{b.material.environmentRotation.makeRotationY(e),b.reset()})),_.add(R,"environmentBlur",0,1).onChange((()=>{S()})),_.add(R,"backgroundBlur",0,1).onChange((()=>{b.reset()})),G()}();
//# sourceMappingURL=materialDatabase.9c81f2f8.js.map

var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},a=e.parcelRequire5b70;null==a&&((a=function(e){if(e in t)return t[e].exports;if(e in n){var a=n[e];delete n[e];var i={id:e,exports:{}};return t[e]=i,a.call(i.exports,i,i.exports),i.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){n[e]=t},e.parcelRequire5b70=a);var i=a("ilwiq"),o=a("RPVlj"),r=a("5Rd1x"),l=a("4CEV9"),s=a("cVdfP"),d=a("jiuw3");i=a("ilwiq");let u,c,m,p,g,h,w,f,b,y;const x={enable:!0,pause:!1,mis:!0,tiles:2,resolutionScale:1/window.devicePixelRatio,color:"#eeeeee",fog:!0,density:.01,lightIntensity:500,lightColor:"#ffffff",bounces:10};function C(){p.reset()}function M(){const e=window.innerWidth,t=window.innerHeight,n=x.resolutionScale,a=window.devicePixelRatio;p.setSize(e*n*a,t*n*a),p.reset(),u.setSize(e,t),u.setPixelRatio(window.devicePixelRatio*n);const i=e/t;h.aspect=i,h.updateProjectionMatrix(),p.reset()}function F(){requestAnimationFrame(F),f.color.set(x.color).convertSRGBToLinear(),f.density=x.density,b.intensity=x.lightIntensity,b.color.set(x.lightColor),p.material.materials.updateFrom(m.materials,m.textures),p.material.lights.updateFrom(m.lights),h.updateMatrixWorld(),p.material.bounces=x.bounces,(p.samples<1||!x.enable)&&u.render(w,h),x.enable&&((!x.pause||p.samples<1)&&p.update(),u.autoClear=!1,g.material.map=p.target.texture,g.render(u),u.autoClear=!0),y.innerText=`Samples: ${Math.floor(p.samples)}`}!async function(){u=new i.WebGLRenderer({antialias:!0}),u.toneMapping=i.ACESFilmicToneMapping,u.outputEncoding=i.sRGBEncoding,u.setClearColor(0,0),document.body.appendChild(u.domElement);const e=window.innerWidth/window.innerHeight;h=new l.PhysicalCamera(75,e,.025,500),h.position.set(0,1,6),p=new l.PathTracingRenderer(u),p.alpha=!0,p.material=new l.PhysicalPathTracingMaterial,p.tiles.set(x.tiles,x.tiles),p.camera=h,g=new o.FullScreenQuad(new i.MeshBasicMaterial({map:p.target.texture,blending:i.CustomBlending,premultipliedAlpha:u.getContextAttributes().premultipliedAlpha})),c=new r.OrbitControls(h,u.domElement),c.addEventListener("change",(()=>{p.reset()})),w=new i.Scene,y=document.getElementById("samples"),f=new l.FogVolumeMaterial;const t=new s.PathTracingSceneWorker,n=new i.MeshStandardMaterial({color:10066329,roughness:1,metalness:0}),a=new i.Mesh(new i.BoxGeometry(8,4.05,8),f),v=new i.Mesh(new i.CylinderGeometry(5,5,.1,40),n);v.position.y=-1.1,b=new l.PhysicalSpotLight,b.position.set(0,1,0).multiplyScalar(3),b.angle=Math.PI/4.5,b.decay=2,b.penumbra=.15,b.distance=0,b.intensity=50,b.radius=.05;const P=new i.Group;P.add(b);const S=new i.Mesh(new i.BoxGeometry(.1,.1,2),n);for(let e=0;e<10;e++){const t=S.clone();t.position.x=2*e/9-1,t.position.y=2,P.add(t)}const E=new i.Group;E.add(a,v,P),E.updateMatrixWorld(),m=await t.generate(E),w.add(m.scene);const{bvh:R,textures:T,materials:I}=m,G=R.geometry;p.material.environmentIntensity=0,p.material.bvh.updateFrom(R),p.material.attributesArray.updateFrom(G.attributes.normal,G.attributes.tangent,G.attributes.uv,G.attributes.color),p.material.materialIndexAttribute.updateFrom(G.attributes.materialIndex),p.material.textures.setTextures(u,2048,2048,T),p.material.materials.updateFrom(I,T),p.material.lights.updateFrom(m.lights),t.dispose(),M(),window.addEventListener("resize",M);const A=new d.GUI,B=A.addFolder("Path Tracing");B.add(x,"enable"),B.add(x,"pause"),B.add(x,"bounces",1,20,1).onChange((()=>p.reset())),B.add(x,"mis").onChange((e=>{p.material.setDefine("FEATURE_MIS",Number(e)),p.reset()})),B.add(x,"tiles",1,4,1).onChange((e=>{p.tiles.set(e,e)})),B.add(x,"resolutionScale",.1,1).onChange((()=>{M()}));const L=A.addFolder("fog");L.addColor(x,"color").onChange(C),L.add(x,"density",0,1).onChange(C);const W=A.addFolder("light");W.add(x,"lightIntensity",0,1e3).onChange(C),W.addColor(x,"lightColor").onChange(C),F()}();
//# sourceMappingURL=fog.f4a51521.js.map

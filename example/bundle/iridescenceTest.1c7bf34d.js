var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},t={},a=e.parcelRequire5b70;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in t){var a=t[e];delete t[e];var i={id:e,exports:{}};return n[e]=i,a.call(i.exports,i,i.exports),i.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,n){t[e]=n},e.parcelRequire5b70=a);var i=a("ilwiq"),r=a("RPVlj"),s=a("5Rd1x"),o=a("4CEV9"),d=a("cVdfP"),l=a("891vQ"),c=a("jiuw3");i=a("ilwiq");let u,m,p,g,h,w,f,y,C;const b={enable:!0,pause:!1,mis:!0,tiles:2,resolutionScale:1,color:"#ffcccc",roughness:0,metalness:0,specularIntensity:1,specularColor:"#ffffff",iridescence:0,iridescenceIOR:2,iridescenceThicknessMin:0,iridescenceThicknessMax:400,transmission:0,ior:1.5,opacity:0,fog:!1,density:0};function M(){g.reset()}function x(){const e=window.innerWidth,n=window.innerHeight,t=b.resolutionScale,a=window.devicePixelRatio;g.setSize(e*t*a,n*t*a),g.reset(),u.setSize(e,n),u.setPixelRatio(window.devicePixelRatio*t);const i=e/n;w.aspect=i,w.updateProjectionMatrix(),g.reset()}function R(){requestAnimationFrame(R),y.color.set(b.color).convertSRGBToLinear(),y.roughness=b.roughness,y.metalness=b.metalness,y.thickness=1,y.ior=b.ior,y.transmission=b.transmission,y.iridescence=b.iridescence,y.iridescenceIOR=b.iridescenceIOR,y.iridescenceThicknessRange=[b.iridescenceThicknessMin,b.iridescenceThicknessMax],y.specularIntensity=b.specularIntensity,y.specularColor.set(b.specularColor).convertSRGBToLinear(),y.isFogVolumeMaterial=b.fog,y.opacity=b.fog?b.density:b.opacity,y.density=y.opacity,y.transparent=y.opacity<1,g.material.materials.updateFrom(p.materials,p.textures),w.updateMatrixWorld(),(g.samples<1||!b.enable)&&u.render(f,w),b.enable&&((!b.pause||g.samples<1)&&g.update(),u.autoClear=!1,h.material.map=g.target.texture,h.render(u),u.autoClear=!0),C.innerText=`Samples: ${Math.floor(g.samples)}`}!async function(){u=new i.WebGLRenderer({antialias:!0}),u.toneMapping=i.ACESFilmicToneMapping,u.outputEncoding=i.sRGBEncoding,u.setClearColor(0,0),document.body.appendChild(u.domElement);const e=window.innerWidth/window.innerHeight;w=new o.PhysicalCamera(75,e,.025,500),w.position.set(-4,2,3),g=new o.PathTracingRenderer(u),g.alpha=!0,g.material=new o.PhysicalPathTracingMaterial,g.tiles.set(b.tiles,b.tiles),g.camera=w,h=new r.FullScreenQuad(new i.MeshBasicMaterial({map:g.target.texture,blending:i.CustomBlending,premultipliedAlpha:u.getContextAttributes().premultipliedAlpha})),m=new s.OrbitControls(w,u.domElement),m.addEventListener("change",(()=>{g.reset()})),f=new i.Scene,C=document.getElementById("samples");const n=new URL("../../../shared-assets/environments/lightroom_14b.hdr","https://raw.githubusercontent.com/google/model-viewer/master/packages/render-fidelity-tools/test/config/").toString();await(new l.RGBELoader).setDataType(i.FloatType).loadAsync(n).then((e=>{e.mapping=i.EquirectangularReflectionMapping,f.background=e,f.environment=e,g.material.envMapInfo.updateFrom(e)})),y=new i.MeshPhysicalMaterial;const t=new d.PathTracingSceneWorker,a=new i.Mesh(new i.SphereGeometry(1,50,50),y),T=new i.Mesh(new i.BoxGeometry(10,.01,10),new i.MeshStandardMaterial({color:16777215,roughness:1,metalness:0}));T.position.y=-1;const v=new i.RectAreaLight(16777215,10,3,3);v.rotation.x=-Math.PI/4,v.position.set(0,1,1).multiplyScalar(3);const I=new i.Group;I.add(a,T,v),p=await t.generate(I),f.add(p.scene);const{bvh:S,textures:E,materials:F}=p,P=S.geometry;g.material.environmentIntensity=0,g.material.bvh.updateFrom(S),g.material.attributesArray.updateFrom(P.attributes.normal,P.attributes.tangent,P.attributes.uv,P.attributes.color),g.material.materialIndexAttribute.updateFrom(P.attributes.materialIndex),g.material.textures.setTextures(u,2048,2048,E),g.material.materials.updateFrom(F,E),g.material.lights.updateFrom(p.lights),t.dispose(),document.getElementById("loading").remove(),x(),window.addEventListener("resize",x);const k=new c.GUI,A=k.addFolder("Path Tracing");A.add(b,"enable"),A.add(b,"pause"),A.add(b,"mis").onChange((e=>{g.material.setDefine("FEATURE_MIS",Number(e)),g.reset()})),A.add(b,"tiles",1,4,1).onChange((e=>{g.tiles.set(e,e)})),A.add(b,"resolutionScale",.1,1).onChange((()=>{x()}));const B=k.addFolder("Material");B.addColor(b,"color").onChange(M),B.add(b,"roughness",0,1).onChange(M),B.add(b,"metalness",0,1).onChange(M),B.add(b,"specularIntensity",0,1).onChange(M),B.addColor(b,"specularColor").onChange(M),B.add(b,"transmission",0,1).onChange(M),B.add(b,"ior",1,2).onChange(M),B.add(b,"iridescence",0,1).onChange(M),B.add(b,"iridescenceIOR",1,2).onChange(M),B.add(b,"iridescenceThicknessMin",0,1e3,1).onChange(M),B.add(b,"iridescenceThicknessMax",0,1e3,1).onChange(M),B.add(b,"opacity",0,1).onChange(M),B.add(b,"fog").onChange(M),B.add(b,"density",0,100).onChange(M),R()}();
//# sourceMappingURL=iridescenceTest.1c7bf34d.js.map
